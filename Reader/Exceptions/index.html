<!DOCTYPE html>
<html class="html">
<head>
    <meta charset="utf-8" />
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />

    <style>
        .hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .form {
            position: relative;
            z-index: 1;
            background: #ffffff;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            border-radius: 3px;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2),
            0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
            border-radius: 3px;
        }

        .form .decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #00cae9;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #ffffff;
            font-size: 14px;
            cursor: pointer;
            border-radius: 3px;
        }

        .form .decrypt-button:active {
            background: #009db5;
        }

        .html {
            height: 100%;
        }

        .body {
            margin-bottom: 1em;
            background: #00cae9;
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .title {
            font-size: 1.5em;
        }
    </style>
</head>

<body class="body" onload="onload()">
<div class="page">
    <div class="form">
        <div class="instructions">
            <p class="title">Protected Page</p>
        </div>

        <hr class="hr" />

        <form id="form" action="#" method="post">
            <input id="password" type="password" name="password" placeholder="Password" autofocus />
            <input type="submit" class="decrypt-button" value="DECRYPT"/>
        </form>
    </div>
</div>

<script>
    const STORAGE_KEY = 'coverage';

    function decryptContent(encryptedMsg, pass) {
        const salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        const iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32));
        const encrypted = encryptedMsg.substring(64);

        const key = CryptoJS.PBKDF2(pass, salt, {
            keySize: 8,
            iterations: 10
        });

        return CryptoJS.AES.decrypt(encrypted, key, {
            iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
    }

    function decryptAndReplace(pass, suppress = false) {
        const encryptedMsg = "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";
        const encryptedHMAC = encryptedMsg.substring(0, 64);
        const encryptedHTML = encryptedMsg.substring(64);
        const decryptedHMAC = CryptoJS.HmacSHA256(
            encryptedHTML,
            CryptoJS.SHA256(pass).toString()
        ).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            if (!suppress) {
                alert( 'Wrong password!' );
            }
            sessionStorage.removeItem(STORAGE_KEY);
            return false;
        }

        // Save for the session
        sessionStorage.setItem(STORAGE_KEY, pass);

        const plainHTML = decryptContent(encryptedHTML, pass);

        document.write(plainHTML);
        document.close();

        return true;
    }

    function onload() {
        if (sessionStorage.getItem(STORAGE_KEY) && decryptAndReplace(sessionStorage.getItem(STORAGE_KEY),true)) {

            return;

        }

        // Show page because there isn't a good password
        // Otherwise, document.write would have stop this
        document
        .querySelectorAll(".body")
        .forEach(el => (el.style.display = "block"));

        document
        .getElementById("form")
        .addEventListener("submit", e => {
            e.preventDefault();

            decryptAndReplace(
                document.getElementById("password").value
            );
        });
    }
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>
</body>
</html>
